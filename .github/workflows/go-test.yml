name: Integration + Unit Tests

on: push

jobs:
  test:
    env:
      NORDVPN_SERVER_LIST_URL: ${{ secrets.NORDVPN_SERVER_LIST_URL }}
      NORDVPN_CREDENTIALS_URL: ${{ secrets.NORDVPN_CREDENTIALS_URL }}
      NORDVPN_TOKEN: ${{ secrets.NORDVPN_TOKEN }}
    strategy:
      matrix:
        os: [ ubuntu-latest, macos-latest ]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v6
      - uses: actions/setup-go@v6
        with:
          go-version: 1.26
          cache: true
      - run: |
          go vet ./...
          go test -tags=integration ./...
